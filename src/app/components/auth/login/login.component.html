<section class="my-5 d-flex flex-column">
  <div class="container">
    <h1 class="display-4 text-secondary text-center">Login</h1>
    <div class="row">
      <div class="col-12 col-md-8 col-xl-6 mx-auto">
        <!-- ! is loading-->
        <app-loader *ngIf="isLoading && !isError"></app-loader>
        <!-- ! is error-->

        <app-error *ngIf="isError" [message]="isError"></app-error>
        <!-- ! card login -->
        <mat-card
          *ngIf="!isLoading"
          class="d-flex flex-column justify-content-around"
        >
          <form
            #form="ngForm"
            (ngSubmit)="onSubmit(form)"
            class="d-flex flex-column justify-content-around h-75"
          >
            <mat-form-field
              hintLabel="email must be correct"
              color="accent"
              class="mt-3"
            >
              <mat-label>Email</mat-label>
              <input
                required
                minlength="5"
                [ngClass]="{
                  invalid: email.invalid && (email.touched || email.dirty),
                  valid: email.valid
                }"
                matInput
                pattern="[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)"
                name="email"
                ngModel
                #email="ngModel"
              />
              <mat-error
                *ngIf="
                  email.invalid &&
                  (email.touched || email.dirty) &&
                  !email.errors?.minlength
                "
              >
                please enter a valid email
              </mat-error>
              <mat-error *ngIf="email.errors?.pattern">
                email format is wrong
              </mat-error>
              <mat-hint align="end"> {{ email.value?.length }}/50 </mat-hint>
            </mat-form-field>
            <mat-form-field
              hintLabel="password must be 8 chars min"
              class="my-3"
              color="accent"
            >
              <mat-label>Password</mat-label>
              <input
                required
                minlength="8"
                [ngClass]="{
                  invalid:
                    password.invalid && (password.touched || password.dirty),
                  valid: password.valid
                }"
                pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,}"
                matInput
                name="password"
                ngModel
                #password="ngModel"
              />
              <mat-error
                *ngIf="
                  password.invalid &&
                  (password.touched || password.dirty) &&
                  !password.errors?.pattern
                "
              >
                please enter a valid password
              </mat-error>
              <mat-error *ngIf="password.errors?.pattern">
                password format is wrong
              </mat-error>
              <mat-hint align="end"> {{ password.value?.length }}/30 </mat-hint>
            </mat-form-field>
            <button
              [disabled]="!form.valid"
              mat-raised-button
              color="warn"
              class="d-block mx-auto"
            >
              Login
            </button>
          </form>
        </mat-card>
      </div>
    </div>
    <div class="row mt-5">
      <div class="col mx-auto">
        <h6 class="text-center lead">
          Not yet a user ?
          <button
            routerLink="/signup"
            mat-flat-button
            color="primary"
            class="ml-3"
          >
            Signup Now
          </button>
        </h6>
      </div>
    </div>
  </div>
</section>
